<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Delta 360 | Dispatch Command Center</title>
  <meta name="description" content="Professional team dispatch command center powered by GroupMe.">
  <meta name="theme-color" content="#f97316">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' fill='%23f97316'>Î”</text></svg>">
  
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/components.css">
</head>
<body>

  <!-- LOGIN SCREEN -->
  <div id="login">
    <div class="login-card">
      <div class="lb">Î”</div>
      <div class="sub">Delta 360</div>
      <div class="input-group">
        <input type="password" id="tok" placeholder="GroupMe API Token" onkeydown="if(event.key==='Enter')doLogin()">
        <button class="lbtn" onclick="doLogin()">Connect</button>
      </div>
      <div id="lerr">Connection failed. Please check your token.</div>
      <div class="meta-link">
        <a href="https://dev.groupme.com" target="_blank">Get API Token â†’</a>
      </div>
    </div>
  </div>

  <!-- MAIN APPLICATION -->
  <div id="app-root" style="display:none; flex: 1; display: flex; flex-direction: column;">
    
    <!-- HEADER -->
    <header>
      <div class="brand-section">
        <button id="sb-toggle" onclick="tglSidebar()" title="Toggle Menu">â˜°</button>
        <div class="brand-icon">Î”</div>
        <div class="brand-text">
          <div class="hm" id="htitle">Dashboard</div>
          <div class="hs">Delta 360</div>
        </div>
      </div>

      <div class="tools-section">
        <div class="status-pill" id="stat-pill">
          <span class="dot"></span>
          <span id="stat-text">Offline</span>
          <select id="statSel" onchange="setStat(this.value, true)">
            <option value="avl">Available</option>
            <option value="bsy">Busy</option>
            <option value="awy">Away</option>
          </select>
        </div>

        <div class="divider-v"></div>

        <button class="ib" onclick="toggleSearch()" title="Search">
          <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
        </button>
        
        <button class="ib" onclick="showMembers()" title="Members">
          <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 00-3-3.87"/>
            <path d="M16 3.13a4 4 0 010 7.75"/>
          </svg>
        </button>

        <button class="ib" id="vb" onclick="toggleMute()" title="Sound">
          <span id="vb-icon">ðŸ”Š</span>
        </button>

        <div class="tray-w">
          <button class="tbtn" onclick="tglTray('toolsTray',this)">Tools</button>
          <div class="tray" id="toolsTray">
            <button class="tray-i" onclick="showContacts();closeTray()">Contacts</button>
            <button class="tray-i" onclick="showAdhoc();closeTray()">Broadcast</button>
            <button class="tray-i" onclick="toggleCB();closeTray()">Clipboard</button>
            <div class="tray-sep"></div>
            <button class="tray-i" onclick="toggleCfg();closeTray()">Settings</button>
          </div>
        </div>

        <div class="tray-w">
          <button class="tbtn" onclick="tglTray('viewTray',this)">View</button>
          <div class="tray" id="viewTray">
            <button class="tray-i" onclick="toggleTheme();closeTray()">Theme</button>
            <button class="tray-i" onclick="toggleCompact();closeTray()">Compact</button>
            <div class="tray-sep"></div>
            <button class="tray-i" onclick="doLogout()">Log Out</button>
          </div>
        </div>
      </div>
    </header>

    <!-- DISPATCH BOARD -->
    <div id="dboard"></div>

    <!-- MAIN CONTENT -->
    <div id="main">
      
      <!-- SIDEBAR -->
      <div id="sidebar">
        <div class="sb-section-hdr">Feeds</div>
        <div id="sL"></div>
        
        <div class="sb-section-hdr">Active</div>
        <div id="aL"></div>
      </div>

      <!-- FEED PANEL -->
      <div id="feed">
        
        <!-- SEARCH OVERLAY -->
        <div class="ov" id="searchOv">
          <div class="ov-hdr">
            <div class="ot">Search Archives</div>
            <button class="oclose" onclick="toggleSearch()">âœ•</button>
          </div>
          <input id="searchIn" class="rin large" placeholder="Search messages..." oninput="doSearch(this.value)">
          <div id="searchRes"></div>
        </div>

        <!-- CONFIG OVERLAY -->
        <div id="cfg" style="display:none">
          <div class="cfg-grid">
            <div class="cfg-col">
              <div class="ot" style="margin-bottom: 16px;">Audio Settings</div>
              <div class="cfg-row">
                <label>Feed Sound</label>
                <select id="feedSndSel" onchange="feedSound=this.value;localStorage.setItem('gm_v3_feedsnd',this.value)">
                  <option value="radar">Radar</option>
                  <option value="chime">Chime</option>
                  <option value="click">Click</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- PANELS -->
        <div id="panels-wrap">
          <div class="panel" id="panel-0">
            
            <!-- STICKY NOTES -->
            <div id="sticky-bar">
              <span class="stl">Note</span>
              <input id="sticky-text" placeholder="Add a note..." onblur="saveSticky()">
            </div>
            
            <!-- MESSAGE LOG -->
            <div class="fs" id="log">
              <div class="empty">
                <div class="ei">Î”</div>
                <div class="el">Ready</div>
              </div>
            </div>
            
            <!-- MESSAGE INPUT -->
            <div id="bb">
              <button class="att-btn" onclick="document.getElementById('imgUp').click()" title="Attach Image">+</button>
              <input type="file" id="imgUp" accept="image/*" style="display:none" onchange="handleImg(this)">
              
              <textarea id="gIn" class="rin" placeholder="Type message..." oninput="autoX(this)" onkeydown="bKey(event)"></textarea>
              
              <button class="sb" onclick="sendBcast()">Send</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- NOTIFICATIONS -->
  <div id="toast-zone"></div>

  <!-- APPLICATION SCRIPT -->
  <script src="js/app.js"></script>
</body>
</html>
